{"ast":null,"code":"import axios from 'axios';\n\n// Configuration\nexport const apiBase = process.env.REACT_APP_API_BASE || (process.env.NODE_ENV === 'production' ? '' // Empty string for same-origin requests in production\n: 'http://localhost:8000');\n\n// Create Axios instance with default config\nconst apiClient = axios.create({\n  baseURL: apiBase,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  withCredentials: true,\n  // Enable sending cookies in cross-origin requests\n  // Optional: timeout after 10 seconds\n  timeout: 10000\n});\n\n// --- TOKEN MANAGEMENT ---\nexport function getToken() {\n  return localStorage.getItem('token');\n}\nexport function setToken(token) {\n  if (token) {\n    localStorage.setItem('token', token);\n  } else {\n    localStorage.removeItem('token');\n  }\n}\n\n// --- AXIOS INTERCEPTORS ---\n\n// 1. Request Interceptor: Auto-attach token\napiClient.interceptors.request.use(config => {\n  const token = getToken();\n  // If token exists, attach it to the Authorization header\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// 2. Response Interceptor: Centralized error handling and data extraction\napiClient.interceptors.response.use(response => {\n  // Return just the data to simplify calls in components\n  return response.data;\n}, error => {\n  // Handle standard HTTP errors\n  let errorMessage = 'An unexpected error occurred.';\n  if (error.response) {\n    var _error$response$data;\n    // Server responded with a status code outside the 2xx range\n    // Try to get the specific error message sent by the server (e.g., res.status(400).send(\"Invalid password\"))\n    errorMessage = ((_error$response$data = error.response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.response.data || error.response.statusText;\n\n    // Optional: Handle specific status codes globally (e.g., auto-logout on 401)\n    if (error.response.status === 401) {\n      // setToken(null); \n      // window.location.href = '/login';\n    }\n  } else if (error.request) {\n    // The request was made but no response was received (network error, server down)\n    errorMessage = 'Network error. Please check your connection.';\n  } else {\n    // Something happened in setting up the request\n    errorMessage = error.message;\n  }\n\n  // Reject the promise with a clean error object or string\n  // We throw an Error object so components can catch it easily: catch (err) { setText(err.message) }\n  return Promise.reject(new Error(errorMessage));\n});\n\n// --- API METHODS ---\n\n// Auth\nexport function login(username, password) {\n  return apiClient.post('/api/login', {\n    username,\n    password\n  });\n}\nexport function register(firstName, lastName, email, username, password) {\n  return apiClient.post('/api/register', {\n    firstName,\n    lastName,\n    email,\n    username,\n    password\n  });\n}\nexport function fetchAuthStatus() {\n  return apiClient.get('/api/auth_status');\n}\n\n// Transactions\nexport function fetchTransactions() {\n  return apiClient.get('/api/transactions');\n}\nexport function addTransaction(payload) {\n  // payload = { description, amount, type, category }\n  return apiClient.post('/api/transactions', payload);\n}\nexport function deleteTransaction(id) {\n  return apiClient.delete(`/api/transactions/${id}`);\n}\nexport function resetTransactions() {\n  return apiClient.delete('/api/transactions/reset');\n}\n\n// Budget\nexport function fetchBudget() {\n  return apiClient.get('/api/budget');\n}\nexport function setBudget(amount) {\n  return apiClient.post('/api/budget', {\n    amount\n  });\n}\nexport function AdivisorAI() {\n  return apiClient.post('/api/coach');\n}\n_c = AdivisorAI;\nvar _c;\n$RefreshReg$(_c, \"AdivisorAI\");","map":{"version":3,"names":["axios","apiBase","process","env","REACT_APP_API_BASE","NODE_ENV","apiClient","create","baseURL","headers","withCredentials","timeout","getToken","localStorage","getItem","setToken","token","setItem","removeItem","interceptors","request","use","config","Authorization","error","Promise","reject","response","data","errorMessage","_error$response$data","message","statusText","status","Error","login","username","password","post","register","firstName","lastName","email","fetchAuthStatus","get","fetchTransactions","addTransaction","payload","deleteTransaction","id","delete","resetTransactions","fetchBudget","setBudget","amount","AdivisorAI","_c","$RefreshReg$"],"sources":["/home/stuban/Downloads/Minor project/frontend/src/api.js"],"sourcesContent":["import axios from 'axios';\n\n// Configuration\nexport const apiBase = process.env.REACT_APP_API_BASE || (\n    process.env.NODE_ENV === 'production' \n        ? '' // Empty string for same-origin requests in production\n        : 'http://localhost:8000'\n);\n\n// Create Axios instance with default config\nconst apiClient = axios.create({\n    baseURL: apiBase,\n    headers: {\n        'Content-Type': 'application/json',\n    },\n    withCredentials: true, // Enable sending cookies in cross-origin requests\n    // Optional: timeout after 10 seconds\n    timeout: 10000,\n});\n\n// --- TOKEN MANAGEMENT ---\nexport function getToken() {\n    return localStorage.getItem('token');\n}\n\nexport function setToken(token) {\n    if (token) {\n        localStorage.setItem('token', token);\n    } else {\n        localStorage.removeItem('token');\n    }\n}\n\n// --- AXIOS INTERCEPTORS ---\n\n// 1. Request Interceptor: Auto-attach token\napiClient.interceptors.request.use(\n    (config) => {\n        const token = getToken();\n        // If token exists, attach it to the Authorization header\n        if (token) {\n            config.headers.Authorization = `Bearer ${token}`;\n        }\n        return config;\n    },\n    (error) => {\n        return Promise.reject(error);\n    }\n);\n\n// 2. Response Interceptor: Centralized error handling and data extraction\napiClient.interceptors.response.use(\n    (response) => {\n        // Return just the data to simplify calls in components\n        return response.data;\n    },\n    (error) => {\n        // Handle standard HTTP errors\n        let errorMessage = 'An unexpected error occurred.';\n\n        if (error.response) {\n            // Server responded with a status code outside the 2xx range\n            // Try to get the specific error message sent by the server (e.g., res.status(400).send(\"Invalid password\"))\n            errorMessage = error.response.data?.message || error.response.data || error.response.statusText;\n\n            // Optional: Handle specific status codes globally (e.g., auto-logout on 401)\n            if (error.response.status === 401) {\n                // setToken(null); \n                // window.location.href = '/login';\n            }\n        } else if (error.request) {\n            // The request was made but no response was received (network error, server down)\n            errorMessage = 'Network error. Please check your connection.';\n        } else {\n            // Something happened in setting up the request\n            errorMessage = error.message;\n        }\n\n        // Reject the promise with a clean error object or string\n        // We throw an Error object so components can catch it easily: catch (err) { setText(err.message) }\n        return Promise.reject(new Error(errorMessage));\n    }\n);\n\n// --- API METHODS ---\n\n// Auth\nexport function login(username, password) {\n    return apiClient.post('/api/login', { username, password });\n}\n\nexport function register(firstName, lastName, email, username, password) {\n    return apiClient.post('/api/register', { \n        firstName, \n        lastName, \n        email, \n        username, \n        password \n    });\n}\n\nexport function fetchAuthStatus() {\n    return apiClient.get('/api/auth_status');\n}\n\n// Transactions\nexport function fetchTransactions() {\n    return apiClient.get('/api/transactions');\n}\n\nexport function addTransaction(payload) {\n    // payload = { description, amount, type, category }\n    return apiClient.post('/api/transactions', payload);\n}\n\nexport function deleteTransaction(id) {\n    return apiClient.delete(`/api/transactions/${id}`);\n}\n\nexport function resetTransactions() {\n    return apiClient.delete('/api/transactions/reset');\n}\n\n// Budget\nexport function fetchBudget() {\n    return apiClient.get('/api/budget');\n}\n\nexport function setBudget(amount) {\n    return apiClient.post('/api/budget', { amount });\n}\n\nexport function AdivisorAI() {\n\n    return apiClient.post('/api/coach');\n}"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;;AAEzB;AACA,OAAO,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,kBAAkB,KACjDF,OAAO,CAACC,GAAG,CAACE,QAAQ,KAAK,YAAY,GAC/B,EAAE,CAAC;AAAA,EACH,uBAAuB,CAChC;;AAED;AACA,MAAMC,SAAS,GAAGN,KAAK,CAACO,MAAM,CAAC;EAC3BC,OAAO,EAAEP,OAAO;EAChBQ,OAAO,EAAE;IACL,cAAc,EAAE;EACpB,CAAC;EACDC,eAAe,EAAE,IAAI;EAAE;EACvB;EACAC,OAAO,EAAE;AACb,CAAC,CAAC;;AAEF;AACA,OAAO,SAASC,QAAQA,CAAA,EAAG;EACvB,OAAOC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;AACxC;AAEA,OAAO,SAASC,QAAQA,CAACC,KAAK,EAAE;EAC5B,IAAIA,KAAK,EAAE;IACPH,YAAY,CAACI,OAAO,CAAC,OAAO,EAAED,KAAK,CAAC;EACxC,CAAC,MAAM;IACHH,YAAY,CAACK,UAAU,CAAC,OAAO,CAAC;EACpC;AACJ;;AAEA;;AAEA;AACAZ,SAAS,CAACa,YAAY,CAACC,OAAO,CAACC,GAAG,CAC7BC,MAAM,IAAK;EACR,MAAMN,KAAK,GAAGJ,QAAQ,CAAC,CAAC;EACxB;EACA,IAAII,KAAK,EAAE;IACPM,MAAM,CAACb,OAAO,CAACc,aAAa,GAAG,UAAUP,KAAK,EAAE;EACpD;EACA,OAAOM,MAAM;AACjB,CAAC,EACAE,KAAK,IAAK;EACP,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAChC,CACJ,CAAC;;AAED;AACAlB,SAAS,CAACa,YAAY,CAACQ,QAAQ,CAACN,GAAG,CAC9BM,QAAQ,IAAK;EACV;EACA,OAAOA,QAAQ,CAACC,IAAI;AACxB,CAAC,EACAJ,KAAK,IAAK;EACP;EACA,IAAIK,YAAY,GAAG,+BAA+B;EAElD,IAAIL,KAAK,CAACG,QAAQ,EAAE;IAAA,IAAAG,oBAAA;IAChB;IACA;IACAD,YAAY,GAAG,EAAAC,oBAAA,GAAAN,KAAK,CAACG,QAAQ,CAACC,IAAI,cAAAE,oBAAA,uBAAnBA,oBAAA,CAAqBC,OAAO,KAAIP,KAAK,CAACG,QAAQ,CAACC,IAAI,IAAIJ,KAAK,CAACG,QAAQ,CAACK,UAAU;;IAE/F;IACA,IAAIR,KAAK,CAACG,QAAQ,CAACM,MAAM,KAAK,GAAG,EAAE;MAC/B;MACA;IAAA;EAER,CAAC,MAAM,IAAIT,KAAK,CAACJ,OAAO,EAAE;IACtB;IACAS,YAAY,GAAG,8CAA8C;EACjE,CAAC,MAAM;IACH;IACAA,YAAY,GAAGL,KAAK,CAACO,OAAO;EAChC;;EAEA;EACA;EACA,OAAON,OAAO,CAACC,MAAM,CAAC,IAAIQ,KAAK,CAACL,YAAY,CAAC,CAAC;AAClD,CACJ,CAAC;;AAED;;AAEA;AACA,OAAO,SAASM,KAAKA,CAACC,QAAQ,EAAEC,QAAQ,EAAE;EACtC,OAAO/B,SAAS,CAACgC,IAAI,CAAC,YAAY,EAAE;IAAEF,QAAQ;IAAEC;EAAS,CAAC,CAAC;AAC/D;AAEA,OAAO,SAASE,QAAQA,CAACC,SAAS,EAAEC,QAAQ,EAAEC,KAAK,EAAEN,QAAQ,EAAEC,QAAQ,EAAE;EACrE,OAAO/B,SAAS,CAACgC,IAAI,CAAC,eAAe,EAAE;IACnCE,SAAS;IACTC,QAAQ;IACRC,KAAK;IACLN,QAAQ;IACRC;EACJ,CAAC,CAAC;AACN;AAEA,OAAO,SAASM,eAAeA,CAAA,EAAG;EAC9B,OAAOrC,SAAS,CAACsC,GAAG,CAAC,kBAAkB,CAAC;AAC5C;;AAEA;AACA,OAAO,SAASC,iBAAiBA,CAAA,EAAG;EAChC,OAAOvC,SAAS,CAACsC,GAAG,CAAC,mBAAmB,CAAC;AAC7C;AAEA,OAAO,SAASE,cAAcA,CAACC,OAAO,EAAE;EACpC;EACA,OAAOzC,SAAS,CAACgC,IAAI,CAAC,mBAAmB,EAAES,OAAO,CAAC;AACvD;AAEA,OAAO,SAASC,iBAAiBA,CAACC,EAAE,EAAE;EAClC,OAAO3C,SAAS,CAAC4C,MAAM,CAAC,qBAAqBD,EAAE,EAAE,CAAC;AACtD;AAEA,OAAO,SAASE,iBAAiBA,CAAA,EAAG;EAChC,OAAO7C,SAAS,CAAC4C,MAAM,CAAC,yBAAyB,CAAC;AACtD;;AAEA;AACA,OAAO,SAASE,WAAWA,CAAA,EAAG;EAC1B,OAAO9C,SAAS,CAACsC,GAAG,CAAC,aAAa,CAAC;AACvC;AAEA,OAAO,SAASS,SAASA,CAACC,MAAM,EAAE;EAC9B,OAAOhD,SAAS,CAACgC,IAAI,CAAC,aAAa,EAAE;IAAEgB;EAAO,CAAC,CAAC;AACpD;AAEA,OAAO,SAASC,UAAUA,CAAA,EAAG;EAEzB,OAAOjD,SAAS,CAACgC,IAAI,CAAC,YAAY,CAAC;AACvC;AAACkB,EAAA,GAHeD,UAAU;AAAA,IAAAC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}